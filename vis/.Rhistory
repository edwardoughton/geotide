size = 2, data = totals, vjust=-.9, hjust=.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=0, hjust=0) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=0, hjust=.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=0, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=0, hjust=-.3) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=0, hjust=-1) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.5, hjust=-1) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-1) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
path = file.path(folder, 'figures', 'sub-event_infra-type.png')
ggsave(path, units="in", width=8, height=8, dpi=300)
ggplot(subset, aes(x=sub_event_, y=count, fill=actor1)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Actor, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=2, title='Actor')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=sub_event_, y=count, fill=actor1)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Actor, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=2, title='Actor')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=sub_event_, y=count, fill=damage_inf)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Damage, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Damage')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
totals <- subset %>%
group_by(handle, damage_inf) %>%
summarize(count = sum(count))
max_y_value = max(totals$count, na.rm = TRUE)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-1) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-3) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.5, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.4, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Infrastructure Type, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=4, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=actor1)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.4, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Actor, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Actor") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=2, title='Actor')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=damage_inf, y=count, fill=actor1)) +
geom_bar(stat="identity") +
geom_text(aes(damage_inf, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.4, hjust=-.7) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Damage, Actor, Country and Time Period",
x = "Damage Type", y = "Estimated Cell Count", fill="Actor") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=2, title='Actor')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+7)) +
facet_wrap(~handle, ncol=2)
#######by sub-event
totals <- subset %>%
group_by(handle, sub_event_) %>%
summarize(count = sum(count))
max_y_value = max(totals$count, na.rm = TRUE)
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+20)) +
facet_wrap(~handle, ncol=2)
ggplot(subset, aes(x=sub_event_, y=count, fill=infra)) +
geom_bar(stat="identity") +
geom_text(aes(sub_event_, count, label = count,  #y=0,
fill = NULL), show.legend = FALSE, ##FF0000FF
size = 2, data = totals, vjust=.3, hjust=-.5) +
coord_flip() +
theme(legend.position = 'bottom',
axis.text.x = element_text(angle=45, hjust=1)) +
labs(colour=NULL,
title = "Damaged Cell Count Estimate",
subtitle = "Reported by Sub-Event, Infrastructure Type, Country and Time Period.",
x = "Sub-Event", y = "Estimated Cell Count", fill="Infra Type") +
theme(panel.spacing = unit(0.6, "lines")) +
expand_limits(y=0) +
guides(fill=guide_legend(ncol=6, title='Infra Type')) +
scale_fill_viridis_d(direction=1) +
# scale_x_discrete(expand = c(0, 0.15)) +
scale_y_continuous(expand = c(0, 0), limits=c(0, max_y_value+10)) +
facet_wrap(~handle, ncol=2)
source("C:/Users/eoughton/Desktop/Github/geotide/vis/vis.r", echo=TRUE)
